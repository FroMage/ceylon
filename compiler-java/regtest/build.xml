<project name="MyProject" default="compile" basedir=".">
  <property name="src" location="output"/>
  <property name="build" location="classes"/>
  <property name="antlr" location="/home/aph/antlr-3.2/target/antlr-master-3.2-completejar.jar"/>
  <target name="compile" >
    <mkdir dir="${src}" />

    <java classname="org.antlr.Tool">
      <arg value="-o"/> <arg value="${src}"/>
      <arg value="ceylon.g"/>
      <classpath>
        <pathelement location="${antlr}"/>
      </classpath>
    </java>
    
    <javac
       srcdir="${src}" destdir="${build}"
       debug="true"
       classpath="${antlr}">
      <compilerarg file="CeylonCompiler.java"/>
    </javac>

    <apply executable="java">
      <arg value="-cp"/> <arg value="${antlr}:${build}"/>
      <arg value="CeylonCompiler"/>      
      <arg value="-d"/>
      <arg value="tmp"/>
      <fileset dir="/home/aph/ceylon/corpus/tests">
	<include name="*.ceylon"/>
      </fileset>
    </apply>

    <apply executable="diff" failonerror="true">      
      <arg value="-w"/>
      <arg value="tmp"/>
      <fileset dir="/home/aph/ceylon/corpus/tests">
	<include name="*.ceylon.out"/>
      </fileset>
    </apply>

  </target>
</project>
